<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
  <p><button onclick="geoFindMe()">Show my location</button></p>
  <div id="out"></div>
  <div class="message"></div>
</body>

<script>
  function geoFindMe() {
    var output = document.getElementById("out");

    if (!navigator.geolocation){
      output.innerHTML = "<p>Geolocation is not supported by your browser</p>";
      return;
    }

    function success(position) { 
      // This function gets the latitude and longitude, displays them and a map.
      // It ends by calling a function that gets the weather for this location.
      var latitude  = position.coords.latitude;
      var longitude = position.coords.longitude;

      output.innerHTML = '<p>Latitude is ' + latitude + '° <br>Longitude is ' + longitude + '°</p>';

      var img = new Image();
      img.src = "https://maps.googleapis.com/maps/api/staticmap?center=" + latitude + "," + longitude + "&zoom=13&size=300x300&sensor=false";

      output.appendChild(img);

      // This is the call to Open Weather Map API for current weather.
      getWeather(latitude, longitude);
    }

    function error() {
      output.innerHTML = "Unable to retrieve your location";
    }

    function getWeather(latitude, longitude) {
      $.getJSON("http://api.openweathermap.org/data/2.5/weather?lat=" + latitude + "&lon=" + longitude + "&APPID=&callback=?", function(json){
      $(".message").html(JSON.stringify(json));
    });
    }

    output.innerHTML = "<p>Locating…</p>";

    navigator.geolocation.getCurrentPosition(success, error);
  }
</script>